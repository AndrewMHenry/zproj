.PHONY: clean

MAIN_ASM = {main_asm} # name of main assembler source file
APP_ASM  = {app_asm} # name of boilerplate app assembler source file
APP_HEX  = {app_hex} # name of Intel HEX file created by assembler
APP_8XK  = {app_8xk} # signed 8xk file generated by app signer
KEY_FILE = {key_file} # key file used by app signer
INCLUDES = {include_dir} # include directory (used by assembler)

$(APP_8XK): $(APP_HEX)
	rabbitsign -g -k $(KEY_FILE) $(APP_HEX)

$(APP_HEX): $(APP_ASM)
	spasm -I $(INCLUDES) $(APP_ASM) $(APP_HEX)

$(APP_ASM): $(MAIN_ASM)
	zabc $(MAIN_ASM) $(APP_ASM)

clean:
	rm -f $(APP_8XK)
	rm -f $(APP_HEX)
	rm -f $(APP_ASM)
